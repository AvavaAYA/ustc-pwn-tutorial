
>   调试是做题中非常重要的环节，gdb + pwndbg 的组合使用可以给我们做题带来很多便利。

这里也给出 pwndbg 的官方文档：[https://browserpwndbg.readthedocs.io/en/docs/](https://browserpwndbg.readthedocs.io/en/docs/) 和 github 仓库：[https://github.com/pwndbg/pwndbg](https://github.com/pwndbg/pwndbg)

##  pwndbg 安装

在此之前请确保环境中有 `GDB >= 8.1`，然后直接运行以下命令：

```sh
git clone https://github.com/pwndbg/pwndbg
cd pwndbg
./setup.sh
```

---

## pwndbg + gdb 的简单使用

这里先列举几个常用命令并解释其含义，后面会结合上一节的例题 chp0-0 来进一步熟悉部分命令的用法：

| `命令 <参数> [可选参数]` | 简单解释 |
| -- | -- |
| `attach <pid>` | 用 gdb 调试该进程，其中 `<pid>` 指该进程号 |
| `stack [length]` | 查看栈上数据 |
| `telescope <addr>` | 查看目标地址附近数据 |
| `vmmap [addr]` | 查看程序虚拟地址映射情况 |
| `b [addr]` | 下断点 |
| `i <args>` | 获取 info，如 `i b` 可以查看断点信息 |
| `d [bp_id]` | 删除断点 |
| `c` | 继续运行到断点 |
| `ni` | 往下运行一步（不进入函数） |
| `si` | 往下运行一步（进入函数） |
| `finish` | 运行至函数结束 |
| `<ctrl-c>` | 直接断下运行，gdb 命令行接管控制权 |
| `heap [addr]` | 查看堆 |
| `bins` | 查看 bins |
| `p <addr/name>` | 打印信息，也可跟表达式用作简单计算器 |
| `distance <addr1> <addr2>` | 获得地址偏移 |
| `x/32xg <addr>` | x 即 examine，检查目标地址；32为长度；xg 指 16 进制 64 位显示 |

### 例题 chp0-0-hellopwntools

上面命令不必死记硬背，可具体用到时再使用 `help <command>` 了解目标命令的具体用法及参数含义，下面看一下常规调试流程：

#### 写在调试前

在 python 脚本中，pwntools 给调试也提供了接口，~~不过笔者的电脑屏幕太小了，不习惯分屏操作~~ 还是倾向于另开一个窗口使用 `gdb attach <pid>` 来进行调试。

在脚本想要调试的地方加上：

```python
print(p.pid)    #   pwntools 提供的进程 pid
input()         #   用 input 把程序停下来等待 attach
```

#### 简单调试

在 `gdb attach <pid>` 后，应该看到类似如下界面：

![](../assets/chp0-00.png)

<center style="font-size:14px;color:#C0C0C0;text-decoration:underline">图1 gdb + pwndbg 界面</center>
